(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{91:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return s})),t.d(n,"metadata",(function(){return i})),t.d(n,"rightToc",(function(){return c})),t.d(n,"default",(function(){return u}));var o=t(2),r=t(6),a=(t(0),t(99)),s={id:"overview",title:"Overview",sidebar_label:"Overview"},i={unversionedId:"react/overview",id:"react/overview",isDocsHomePage:!1,title:"Overview",description:"React Hooks are powerful",source:"@site/docs/react/overview.md",slug:"/react/overview",permalink:"/elementos-docs/docs/react/overview",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/react/overview.md",version:"current",sidebar_label:"Overview",sidebar:"main",previous:{title:"batched",permalink:"/elementos-docs/docs/guides/batched"},next:{title:"useConstructor",permalink:"/elementos-docs/docs/react/useConstructor"}},c=[{value:"React Hooks are powerful",id:"react-hooks-are-powerful",children:[{value:"Faulty Abstraction",id:"faulty-abstraction",children:[]},{value:"Tight Coupling",id:"tight-coupling",children:[]},{value:"Web Consistency",id:"web-consistency",children:[]},{value:"Inefficient",id:"inefficient",children:[]}]},{value:"React with elementos",id:"react-with-elementos",children:[{value:"Installation",id:"installation",children:[]},{value:"Local State",id:"local-state",children:[]},{value:"Effects",id:"effects",children:[]},{value:"Refs",id:"refs",children:[]},{value:"Global State",id:"global-state",children:[]}]}],l={rightToc:c};function u(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(a.b)("wrapper",Object(o.a)({},l,t,{components:n,mdxType:"MDXLayout"}),Object(a.b)("h2",{id:"react-hooks-are-powerful"},"React Hooks are powerful"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},Object(a.b)("em",{parentName:"strong"},"but")),", they're lacking in several ways..."),Object(a.b)("h3",{id:"faulty-abstraction"},"Faulty Abstraction"),Object(a.b)("p",null,"Conceptually, once a hook is defined on a component, it is static and cannot be added/removed and cannot change positions. React relies on linters and the rules of hooks to prevent people from making these mistakes, but the better solution is to declare hooks during the construction of a component as opposed to during the render. If we only allow hooks to be declared on construction,  we eliminate the need for linters and rules because the component will never attempt to re-declare them during the render phase."),Object(a.b)("h3",{id:"tight-coupling"},"Tight Coupling"),Object(a.b)("p",null,"Hooks are awesome because they've allowed the community to abstract common needs into libraries. Take for example ",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://react-query.tanstack.com/"}),"react-query"),", which has imensely simplified the way we handle async state in React apps. However, wouldn't it be great if react-query could be used with other UI frameworks like ",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://vuejs.org/"}),"vue"),", ",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://svelte.dev/"}),"svelte"),", or even without a framework? Elementos aims to make this possible by pulling state/effect responsibilities out of React and putting them into a separate package."),Object(a.b)("h3",{id:"web-consistency"},"Web Consistency"),Object(a.b)("p",null,Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://gist.github.com/staltz/868e7e9bc2a7b8c1f754"}),"Functional reactive programming")," has been around for a long time, but in recent years many UI frameworks have embraced it including ember, angular, vue, and svelte. React is pseudo-reactive but hasn't embraced FRP to the extent that other frameworks have and in this way has diverged from the rest of the modern web. Elementos hopes to re-align the React community with other modern web communities."),Object(a.b)("h3",{id:"inefficient"},"Inefficient"),Object(a.b)("p",null,"React encourages us to put our business logic in the render function of our components, but this leads to unneccesary recomputation of values. We have the option to bail out of these recomputations via useMemo and useCallback, but the better solution is to run business logic only as much as necessary, which elementos encourages us to do via ",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"/docs/guides/derived"}),"derived observables"),"."),Object(a.b)("h2",{id:"react-with-elementos"},"React with elementos"),Object(a.b)("h3",{id:"installation"},"Installation"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-bash"}),"npm install --save elementos-react\n")),Object(a.b)("p",null,"Here's a quick look at how we can use React and elementos together. If you're looking for a more in-depth example, please see the notes app built with React and elementos."),Object(a.b)("h3",{id:"local-state"},"Local State"),Object(a.b)("p",null,"Local state is everywhere in React apps and it's pretty simple with elementos as well. We can initialize and return atoms in a constructor function and then use the ",Object(a.b)("inlineCode",{parentName:"p"},"useObservable")," hook to translate the observables to react state (",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://codesandbox.io/s/elementos-login-form-p8lsj?file=/src/App.js"}),"open in CodeSandbox"),")."),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-js"}),'import React from \'react\';\nimport { \n  Button, \n  Flex, \n  FormControl, \n  FormLabel, \n  Input,\n  Stack\n} from "@chakra-ui/react";\nimport { atom, molecule } from \'elementos\';\nimport { useConstructor, useObservable } from \'elementos-react\';\nimport * as api from "./api";\n\nfunction LoginForm(props) {\n  // highlight-start\n  const { form$, submitting$ } = useConstructor(() => {\n    const submitting$ = atom(false);\n    const form$ = molecule({\n      username: atom(""),\n      password: atom("")\n    });\n    return {\n      form$,\n      submitting$\n    };\n  });\n  // highlight-end\n\n  // highlight-start\n  const form = useObservable(form$);\n  const submitting = useObservable(submitting$);\n  // highlight-end\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    // highlight-start\n    submitting$.actions.set(true);\n    // highlight-end\n    api.logIn(form).finally(() => {\n      // highlight-start\n      submitting$.actions.set(false);\n      // highlight-end\n    });\n  };\n\n  return (\n    <Stack as="form" spacing={4} onSubmit={handleSubmit}>\n      <FormControl id="username">\n        <FormLabel>Username</FormLabel>\n        <Input\n          type="text"\n          value={form.username}\n          onChange={(e) => {\n            // highlight-start\n            form$.children.username.actions.set(e.target.value);\n            // highlight-end\n          }}\n        />\n      </FormControl>\n      <FormControl id="password">\n        <FormLabel>Password</FormLabel>\n        <Input\n          type="password"\n          value={form.password}\n          onChange={(e) => {\n            // highlight-start\n            form$.children.password.actions.set(e.target.value);\n            // highlight-end\n          }}\n        />\n      </FormControl>\n      <Button isLoading={submitting} type="submit">\n        Submit\n      </Button>\n    </Stack>\n  );\n}\n')),Object(a.b)("h3",{id:"effects"},"Effects"),Object(a.b)("p",null,"To achieve effects with elementos, we can set up observers in the constructor function to monitor observables and run effects whenever their values change. Note that the ",Object(a.b)("inlineCode",{parentName:"p"},"observe")," function returns a disposer which we schedule to run when the component unmounts."),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-js"}),'import React from \'react\';\nimport { \n  Button, \n  Flex, \n  FormControl, \n  FormLabel, \n  Input,\n  Stack\n} from "@chakra-ui/react";\nimport { atom, molecule, observe } from \'elementos\';\nimport { useConstructor, useObservable } from \'elementos-react\';\nimport * as api from "./api";\n\nfunction LoginForm(props) {\n  const { form$, submitting$ } = useConstructor(({ beforeUnmount }) => {\n    const submitting$ = atom(false);\n    const form$ = molecule({\n      username: atom(""),\n      password: atom("")\n    });\n\n    // highlight-start\n    beforeUnmount(\n      observe(form$, (form) => {\n        console.log(form)\n      })\n    )\n    // highlight-end\n\n    return {\n      form$,\n      submitting$\n    };\n  });\n\n  const form = useObservable(form$);\n  const submitting = useObservable(submitting$);\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    submitting$.actions.set(true);\n    api.logIn(form).finally(() => {\n      submitting$.actions.set(false);\n    });\n  };\n\n  return (\n    <Stack as="form" spacing={4} onSubmit={handleSubmit}>\n      <FormControl id="username">\n        <FormLabel>Username</FormLabel>\n        <Input\n          type="text"\n          value={form.username}\n          onChange={(e) => {\n            form$.children.username.actions.set(e.target.value);\n          }}\n        />\n      </FormControl>\n      <FormControl id="password">\n        <FormLabel>Password</FormLabel>\n        <Input\n          type="password"\n          value={form.password}\n          onChange={(e) => {\n            form$.children.password.actions.set(e.target.value);\n          }}\n        />\n      </FormControl>\n      <Button isLoading={submitting} type="submit">\n        Submit\n      </Button>\n    </Stack>\n  );\n}\n')),Object(a.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(a.b)("div",Object(o.a)({parentName:"div"},{className:"admonition-heading"}),Object(a.b)("h5",{parentName:"div"},Object(a.b)("span",Object(o.a)({parentName:"h5"},{className:"admonition-icon"}),Object(a.b)("svg",Object(o.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(a.b)("path",Object(o.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"Disposing Observers")),Object(a.b)("div",Object(o.a)({parentName:"div"},{className:"admonition-content"}),Object(a.b)("p",{parentName:"div"},"We should take care to dispose of any observers before the component unmounts. The constructor takes a ",Object(a.b)("inlineCode",{parentName:"p"},"beforeUnmount")," argument that let's use queue disposal functions."))),Object(a.b)("h3",{id:"refs"},"Refs"),Object(a.b)("p",null,"Who needs refs when you've got atoms? Because refs are essentially just state that doesn't cause a component to re-rerender, atoms are a natural substitute for refs with the added benefit that they're observable."),Object(a.b)("p",null,Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://codesandbox.io/s/elementos-login-form-p8lsj?file=/src/App.js"}),"Open in CodeSandbox")),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-js"}),'import React from \'react\';\nimport { \n  Button, \n  Flex, \n  FormControl, \n  FormLabel, \n  Input,\n  Stack\n} from "@chakra-ui/react";\nimport { atom, molecule, observe } from \'elementos\';\nimport { useConstructor, useObservable } from \'elementos-react\';\nimport * as api from "./api";\n\nfunction LoginForm(props) {\n  const { \n    formEl$, \n    form$, \n    submitting$ \n  } = useConstructor(({ beforeUnmount }) => {\n    // highlight-start\n    const formEl$ = atom(null);\n    // highlight-end\n    const submitting$ = atom(false);\n    const form$ = molecule({\n      username: atom(""),\n      password: atom(""),\n      formEl$\n    });\n\n    // highlight-start\n    beforeUnmount(\n      // log whenever formEl changes\n      observe(formEl$, (formEl) => {\n        console.log(formEl)\n      })\n    )\n    // highlight-end\n\n    beforeUnmount(\n      observe(form$, (form) => {\n        console.log(form)\n      })\n    )\n    \n    return {\n      formEl$,\n      form$,\n      submitting$\n    };\n  });\n\n  const form = useObservable(form$);\n  const submitting = useObservable(submitting$);\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    submitting$.actions.set(true);\n    api.logIn(form).finally(() => {\n      submitting$.actions.set(false);\n    });\n  };\n\n  return (\n    // highlight-next-line\n    <Stack ref={formEl$.actions.set} as="form" spacing={4} onSubmit={handleSubmit}>\n      <FormControl id="username">\n        <FormLabel>Username</FormLabel>\n        <Input\n          type="text"\n          value={form.username}\n          onChange={(e) => {\n            form$.children.username.actions.set(e.target.value);\n          }}\n        />\n      </FormControl>\n      <FormControl id="password">\n        <FormLabel>Password</FormLabel>\n        <Input\n          type="password"\n          value={form.password}\n          onChange={(e) => {\n            form$.children.password.actions.set(e.target.value);\n          }}\n        />\n      </FormControl>\n      <Button isLoading={submitting} type="submit">\n        Submit\n      </Button>\n    </Stack>\n  );\n}\n')),Object(a.b)("h3",{id:"global-state"},"Global State"),Object(a.b)("p",null,"Global state is easy as well. All we have to do is define our observables outside of our components and then we can use them inside of components to share state across."),Object(a.b)("p",null,Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://codesandbox.io/s/elementos-global-state-dbtkk?file=/src/App.js"}),"Open in CodeSandbox")),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-jsx"}),'import React from \'react\';\nimport { Button, Flex, Heading, Stack } from "@chakra-ui/react";\nimport { atom } from \'elementos\';\nimport { useObservable } from \'elementos-react\';\n\nconst count$ = atom(0, {\n  actions: (set) => ({\n    increment: () => set((prevCount) => prevCount + 1),\n    decrement: () => set((prevCount) => prevCount - 1)\n  })\n});\n\nfunction Display() {\n  const count = useObservable(count$);\n  return <Heading>{count}</Heading>;\n}\n\nfunction Decrement() {\n  return (\n    <Button\n      onClick={() => {\n        count$.actions.decrement();\n      }}\n    >\n      Decrement\n    </Button>\n  );\n}\n\nfunction Increment() {\n  return (\n    <Button\n      onClick={() => {\n        count$.actions.increment();\n      }}\n    >\n      Increment\n    </Button>\n  );\n}\n\nexport default function App() {\n  return (\n    <Flex h="100vh" align="center" justify="center" direction="column">\n      <Display />\n      <Stack isInline spacing={2}>\n        <Decrement />\n        <Increment />\n      </Stack>\n    </Flex>\n  );\n}\n')))}u.isMDXComponent=!0},99:function(e,n,t){"use strict";t.d(n,"a",(function(){return m})),t.d(n,"b",(function(){return d}));var o=t(0),r=t.n(o);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=r.a.createContext({}),u=function(e){var n=r.a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},m=function(e){var n=u(e.components);return r.a.createElement(l.Provider,{value:n},e.children)},b={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},p=r.a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),m=u(t),p=o,d=m["".concat(s,".").concat(p)]||m[p]||b[p]||a;return t?r.a.createElement(d,i(i({ref:n},l),{},{components:t})):r.a.createElement(d,i({ref:n},l))}));function d(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,s=new Array(a);s[0]=p;var i={};for(var c in n)hasOwnProperty.call(n,c)&&(i[c]=n[c]);i.originalType=e,i.mdxType="string"==typeof e?e:o,s[1]=i;for(var l=2;l<a;l++)s[l]=t[l];return r.a.createElement.apply(null,s)}return r.a.createElement.apply(null,t)}p.displayName="MDXCreateElement"}}]);